# combine all matching files into a single string and copy to clipboard, helpful for AI stuff
find_and_bundle() {
  # $1 is the first argument to the function: the specific string to search for

  # Ensure the search string is provided
  if [[ -z "$1" ]]; then
    echo "Usage: find_and_bundle <string>"
    return 1
  fi

  # Use ripgrep to find files containing the specific string
  local files_with_string=($(rg --files-with-matches --no-messages --fixed-strings "$1"))

  # Check if any files were found
  if [[ ${#files_with_string[@]} -eq 0 ]]; then
    echo "No files found with string: $1"
    return 1
  fi

  # Combine contents of the files, separated by "---"
  for file in $files_with_string; do
    cat "$file"
    echo "\n---\n"
  done | pbcopy  # Copy the combined content to the clipboard
}

# for quick gpt prompt generation
files-to-markdown() {
  for file in "$@"; do
    if [[ -f "$file" ]]; then
      echo "### File: $file"
      echo '```'
      cat "$file"
      echo '```'
      echo ''
    else
      echo "File $file does not exist." >&2
    fi
  done
}

ask_llm_claude() {
  if (( $# == 0 )); then
    echo "Usage: ask_llm_claude [claude args...]" >&2
    return 1
  fi

  claude -p "$@"
}

ask_llm_gemini() {
  if (( $# == 0 )); then
    echo "Usage: ask_llm_gemini [gemini args...]" >&2
    return 1
  fi

  # gemini dumps a bunch of junk into stderr by default
  gemini -p "$@" 2>/dev/null
}
# can't use a `?` in a function name, only an alias
alias "ai?"="ask_llm_gemini"
