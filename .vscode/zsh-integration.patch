--- shellIntegration-rc.zsh
+++ shellIntegration-rc.zsh
@@ -11,6 +11,16 @@
 	builtin return
 fi
 
+# Tmux-compatible printf wrapper
+__vsc_printf() {
+    if [ -n "$TMUX" ]; then
+        # Wrap in tmux passthrough: \ePtmux;\e <sequence> \e\\
+        builtin printf "\ePtmux;\e%b\e\\\\" "$1"
+    else
+        builtin printf "%b" "$1"
+    fi
+}
+
 # This variable allows the shell to both detect that VS Code's shell integration is enabled as well
 # as disable it by unsetting the variable.
 VSCODE_SHELL_INTEGRATION=1
@@ -83,13 +93,13 @@
 
 # Report prompt type
 if [ -n "${P9K_SSH:-}" ] || [ -n "${P9K_TTY:-}" ]; then
-	builtin printf '\e]633;P;PromptType=p10k\a'
+	__vsc_printf '\e]633;P;PromptType=p10k\a'
 	# Force shell integration on for p10k
 	# typeset -g POWERLEVEL9K_TERM_SHELL_INTEGRATION=true
 elif [ -n "${ZSH:-}" ] && [ -n "$ZSH_VERSION" ] && (( ${+functions[omz]} )); then
-	builtin printf '\e]633;P;PromptType=oh-my-zsh\a'
+	__vsc_printf '\e]633;P;PromptType=oh-my-zsh\a'
 elif [ -n "${STARSHIP_SESSION_KEY:-}" ]; then
-	builtin printf '\e]633;P;PromptType=starship\a'
+	__vsc_printf '\e]633;P;PromptType=starship\a'
 fi
 
 # Shell integration was disabled by the shell, exit without warning assuming either the shell has
@@ -134,22 +144,22 @@
 envVarsToReport=()
 IFS=',' read -rA envVarsToReport <<< "$__vscode_shell_env_reporting"
 
-builtin printf "\e]633;P;ContinuationPrompt=%s\a" "$(echo "$PS2" | sed 's/\x1b/\\\\x1b/g')"
+__vsc_printf "\e]633;P;ContinuationPrompt=$(echo "$PS2" | sed 's/\x1b/\\\\x1b/g')\a"
 
 # Report this shell supports rich command detection
-builtin printf '\e]633;P;HasRichCommandDetection=True\a'
+__vsc_printf '\e]633;P;HasRichCommandDetection=True\a'
 
 __vsc_prompt_start() {
-	builtin printf '\e]633;A\a'
+	__vsc_printf '\e]633;A\a'
 }
 
 __vsc_prompt_end() {
-	builtin printf '\e]633;B\a'
+	__vsc_printf '\e]633;B\a'
 }
 
 __vsc_update_cwd() {
-	builtin printf '\e]633;P;Cwd=%s\a' "$(__vsc_escape_value "${PWD}")"
+	__vsc_printf "\e]633;P;Cwd=$(__vsc_escape_value "${PWD}")\a"
 }
 
 __update_env_cache_aa() {
@@ -157,7 +167,7 @@
 	local value="$2"
 	if [ $__vsc_use_aa -eq 1 ]; then
 		if [[ "${vsc_aa_env["$key"]}" != "$value" ]]; then
 			vsc_aa_env["$key"]="$value"
-			builtin printf '\e]633;EnvSingleEntry;%s;%s;%s\a' "$key" "$(__vsc_escape_value "$value")" "$__vsc_nonce"
+			__vsc_printf "\e]633;EnvSingleEntry;$key;$(__vsc_escape_value "$value");$__vsc_nonce\a"
 		fi
 	fi
 }
@@ -170,7 +180,7 @@
 		if [[ "${__vsc_env_keys[$i]}" == "$key" ]]; then
 			if [[ "${__vsc_env_values[$i]}" != "$value" ]]; then
 				__vsc_env_values[$i]="$value"
-				builtin printf '\e]633;EnvSingleEntry;%s;%s;%s\a' "$key" "$(__vsc_escape_value "$value")" "$__vsc_nonce"
+				__vsc_printf "\e]633;EnvSingleEntry;$key;$(__vsc_escape_value "$value");$__vsc_nonce\a"
 			fi
 			return
 		fi
@@ -179,19 +189,19 @@
 		# Key does not exist so add key, value pair
 		__vsc_env_keys+=("$key")
 		__vsc_env_values+=("$value")
-		builtin printf '\e]633;EnvSingleEntry;%s;%s;%s\a' "$key" "$(__vsc_escape_value "$value")" "$__vsc_nonce"
+		__vsc_printf "\e]633;EnvSingleEntry;$key;$(__vsc_escape_value "$value");$__vsc_nonce\a"
 }
 
 __vsc_update_env() {
 	if [[ ${#envVarsToReport[@]} -gt 0 ]]; then
-		builtin printf '\e]633;EnvSingleStart;%s;%s;\a' 0 $__vsc_nonce
+		__vsc_printf "\e]633;EnvSingleStart;0;$__vsc_nonce;\a"
 		if [ $__vsc_use_aa -eq 1 ]; then
 			if [[ ${#vsc_aa_env[@]} -eq 0 ]]; then
 				# Associative array is empty, do not diff, just add
 				for key in "${envVarsToReport[@]}"; do
 					if [[ -n "$key" && -n "${(P)key+_}" ]]; then
 						vsc_aa_env["$key"]="${(P)key}"
-						builtin printf '\e]633;EnvSingleEntry;%s;%s;%s\a' "$key" "$(__vsc_escape_value "${(P)key}")" "$__vsc_nonce"
+						__vsc_printf "\e]633;EnvSingleEntry;$key;$(__vsc_escape_value "${(P)key}");$__vsc_nonce\a"
 					fi
 				done
 			else
@@ -213,7 +223,7 @@
 						value="${(P)key}"
 						__vsc_env_keys+=("$key")
 						__vsc_env_values+=("$value")
-						builtin printf '\e]633;EnvSingleEntry;%s;%s;%s\a' "$key" "$(__vsc_escape_value "$value")" "$__vsc_nonce"
+						__vsc_printf "\e]633;EnvSingleEntry;$key;$(__vsc_escape_value "$value");$__vsc_nonce\a"
 					fi
 				done
 			else
@@ -227,41 +237,41 @@
 			fi
 		fi
 
-		builtin printf '\e]633;EnvSingleEnd;%s;\a' $__vsc_nonce
+		__vsc_printf "\e]633;EnvSingleEnd;$__vsc_nonce;\a"
 	fi
 }
 
 __vsc_command_output_start() {
-	builtin printf '\e]633;E;%s;%s\a' "$(__vsc_escape_value "${__vsc_current_command}")" $__vsc_nonce
-	builtin printf '\e]633;C\a'
+	__vsc_printf "\e]633;E;$(__vsc_escape_value "${__vsc_current_command}");$__vsc_nonce\a"
+	__vsc_printf '\e]633;C\a'
 }
 
 __vsc_continuation_start() {
-	builtin printf '\e]633;F\a'
+	__vsc_printf '\e]633;F\a'
 }
 
 __vsc_continuation_end() {
-	builtin printf '\e]633;G\a'
+	__vsc_printf '\e]633;G\a'
 }
 
 __vsc_right_prompt_start() {
-	builtin printf '\e]633;H\a'
+	__vsc_printf '\e]633;H\a'
 }
 
 __vsc_right_prompt_end() {
-	builtin printf '\e]633;I\a'
+	__vsc_printf '\e]633;I\a'
 }
 
 __vsc_command_complete() {
 	if [[ "$__vsc_current_command" == "" ]]; then
-		builtin printf '\e]633;D\a'
+		__vsc_printf '\e]633;D\a'
 	else
-		builtin printf '\e]633;D;%s\a' "$__vsc_status"
+		__vsc_printf "\e]633;D;$__vsc_status\a"
 	fi
 	__vsc_update_cwd
 }